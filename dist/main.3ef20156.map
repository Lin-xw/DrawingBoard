{"version":3,"sources":["main.js"],"names":["canvas","document","getElementById","ctx","getContext","eraser","brush","reSetCanvas","aColorBtn","getElementsByClassName","save","undo","range","clear","activeColor","lWidth","autoSetSize","setCanvasBg","listenToUser","getColor","window","onbeforeunload","canvasSetSize","pageWidth","documentElement","clientWidth","pageHeight","clientHeight","width","height","onresize","color","fillStyle","fillRect","painting","lastPoint","x","undefined","y","body","ontouchstart","e","firstDot","getImageData","saveData","touches","clientX","clientY","drawCircle","ontouchmove","newPoint","drawLine","ontouchend","onmousedown","onmousemove","onmouseup","mouseleave","radius","beginPath","arc","Math","PI","fill","clip","clearRect","restore","x1","y1","x2","y2","lineWidth","lineCap","lineJoin","globalCompositeOperation","moveTo","lineTo","stroke","closePath","onchange","value","onclick","classList","add","remove","imgUrl","toDataURL","saveA","createElement","appendChild","href","download","Date","getTime","target","click","i","length","style","backgroundColor","strokeStyle","historyDeta","data","shift","push","putImageData","pop"],"mappings":"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","file":"main.3ef20156.map","sourceRoot":"..\\src","sourcesContent":["let canvas = document.getElementById(\"drawing-board\");\r\nlet ctx = canvas.getContext(\"2d\");\r\nlet eraser = document.getElementById(\"eraser\");\r\nlet brush = document.getElementById(\"brush\");\r\nlet reSetCanvas = document.getElementById(\"clear\");\r\nlet aColorBtn = document.getElementsByClassName(\"color-item\");\r\nlet save = document.getElementById(\"save\");\r\nlet undo = document.getElementById(\"undo\");\r\nlet range = document.getElementById(\"range\");\r\nlet clear = false;\r\nlet activeColor = 'black';\r\nlet lWidth = 4;\r\n\r\nautoSetSize(canvas);\r\n\r\nsetCanvasBg('white');\r\n\r\nlistenToUser(canvas);\r\n\r\ngetColor();\r\n\r\nwindow.onbeforeunload = function(){\r\n  return \"Reload site?\";\r\n};\r\n\r\nfunction autoSetSize(canvas) {\r\n  canvasSetSize();\r\n\r\n  function canvasSetSize() {\r\n    let pageWidth = document.documentElement.clientWidth;\r\n    let pageHeight = document.documentElement.clientHeight;\r\n\r\n    canvas.width = pageWidth;\r\n    canvas.height = pageHeight;\r\n  }\r\n\r\n  window.onresize = function () {\r\n    canvasSetSize();\r\n  }\r\n}\r\n\r\nfunction setCanvasBg(color) {\r\n  ctx.fillStyle = color;\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n  ctx.fillStyle = \"black\";\r\n}\r\n\r\nfunction listenToUser(canvas) {\r\n  let painting = false;\r\n  let lastPoint = {x: undefined, y: undefined};\r\n\r\n  if (document.body.ontouchstart !== undefined) {\r\n    canvas.ontouchstart = function (e) {\r\n      this.firstDot = ctx.getImageData(0, 0, canvas.width, canvas.height);//在这里储存绘图表面\r\n      saveData(this.firstDot);\r\n      painting = true;\r\n      let x = e.touches[0].clientX;\r\n      let y = e.touches[0].clientY;\r\n      lastPoint = {\"x\": x, \"y\": y};\r\n      ctx.save();\r\n      drawCircle(x, y, 0);\r\n    };\r\n    canvas.ontouchmove = function (e) {\r\n      if (painting) {\r\n        let x = e.touches[0].clientX;\r\n        let y = e.touches[0].clientY;\r\n        let newPoint = {\"x\": x, \"y\": y};\r\n        drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y);\r\n        lastPoint = newPoint;\r\n      }\r\n    };\r\n\r\n    canvas.ontouchend = function () {\r\n      painting = false;\r\n    }\r\n  } else {\r\n    canvas.onmousedown = function (e) {\r\n      this.firstDot = ctx.getImageData(0, 0, canvas.width, canvas.height);//在这里储存绘图表面\r\n      saveData(this.firstDot);\r\n      painting = true;\r\n      let x = e.clientX;\r\n      let y = e.clientY;\r\n      lastPoint = {\"x\": x, \"y\": y};\r\n      ctx.save();\r\n      drawCircle(x, y, 0);\r\n    };\r\n    canvas.onmousemove = function (e) {\r\n      if (painting) {\r\n        let x = e.clientX;\r\n        let y = e.clientY;\r\n        let newPoint = {\"x\": x, \"y\": y};\r\n        drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y,clear);\r\n        lastPoint = newPoint;\r\n      }\r\n    };\r\n\r\n    canvas.onmouseup = function () {\r\n      painting = false;\r\n    };\r\n\r\n    canvas.mouseleave = function () {\r\n      painting = false;\r\n    }\r\n  }\r\n}\r\n\r\nfunction drawCircle(x, y, radius) {\r\n  ctx.save();\r\n  ctx.beginPath();\r\n  ctx.arc(x, y, radius, 0, Math.PI * 2);\r\n  ctx.fill();\r\n  if (clear) {\r\n    ctx.clip();\r\n    ctx.clearRect(0,0,canvas.width,canvas.height);\r\n    ctx.restore();\r\n  }\r\n}\r\n\r\nfunction drawLine(x1, y1, x2, y2) {\r\n  ctx.lineWidth = lWidth;\r\n  ctx.lineCap = \"round\";\r\n  ctx.lineJoin = \"round\";\r\n  if (clear) {\r\n    ctx.save();\r\n    ctx.globalCompositeOperation = \"destination-out\";\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x2, y2);\r\n    ctx.stroke();\r\n    ctx.closePath();\r\n    ctx.clip();\r\n    ctx.clearRect(0,0,canvas.width,canvas.height);\r\n    ctx.restore();\r\n  }else{\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x2, y2);\r\n    ctx.stroke();\r\n    ctx.closePath();\r\n  }\r\n}\r\n\r\nrange.onchange = function(){\r\n  lWidth = this.value;\r\n};\r\n\r\neraser.onclick = function () {\r\n  clear = true;\r\n  this.classList.add(\"active\");\r\n  brush.classList.remove(\"active\");\r\n};\r\n\r\nbrush.onclick = function () {\r\n  clear = false;\r\n  this.classList.add(\"active\");\r\n  eraser.classList.remove(\"active\");\r\n};\r\n\r\nreSetCanvas.onclick = function () {\r\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n  setCanvasBg('white');\r\n};\r\n\r\nsave.onclick = function () {\r\n  let imgUrl = canvas.toDataURL(\"image/png\");\r\n  let saveA = document.createElement(\"a\");\r\n  document.body.appendChild(saveA);\r\n  saveA.href = imgUrl;\r\n  saveA.download = \"zspic\" + (new Date).getTime();\r\n  saveA.target = \"_blank\";\r\n  saveA.click();\r\n};\r\n\r\nfunction getColor(){\r\n  for (let i = 0; i < aColorBtn.length; i++) {\r\n    aColorBtn[i].onclick = function () {\r\n      for (let i = 0; i < aColorBtn.length; i++) {\r\n        aColorBtn[i].classList.remove(\"active\");\r\n        this.classList.add(\"active\");\r\n        activeColor = this.style.backgroundColor;\r\n        ctx.fillStyle = activeColor;\r\n        ctx.strokeStyle = activeColor;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nlet historyDeta = [];\r\n\r\nfunction saveData (data) {\r\n  (historyDeta.length === 10) && (historyDeta.shift());// 上限为储存10步，太多了怕挂掉\r\n  historyDeta.push(data);\r\n}\r\n\r\nundo.onclick = function(){\r\n  if(historyDeta.length < 1) return false;\r\n  ctx.putImageData(historyDeta[historyDeta.length - 1], 0, 0);\r\n  historyDeta.pop()\r\n};"]}